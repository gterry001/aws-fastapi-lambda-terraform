# FastAPI Lambda

This Lambda runs the FastAPI application that serves as the main API endpoint for the project.  
It handles incoming HTTP requests from API Gateway and sends messages to an SQS queue for background processing by the worker Lambda.

The function is packaged as a **Docker container image**, built with **AWS CodeBuild** and stored in **Amazon ECR**.  
Terraform then deploys it as an AWS Lambda function and connects it to API Gateway, SQS, and S3.

---

### How it fits in the architecture

- **API Gateway** routes HTTP requests to this Lambda.  
- **FastAPI** handles the request logic and pushes tasks to **SQS**.  
- **Worker Lambda** consumes those messages and processes them asynchronously.  
- **S3** can be used to store files or results generated by either function.

---

### Build and deployment

1. **CodeBuild** clones the GitHub repository and builds the Docker image using the `Dockerfile` in this directory.
2. The image is **tagged and pushed to ECR** (`final_repo_lambda_a`).
3. **Terraform** reads the image URI from ECR and deploys the Lambda, setting up environment variables such as:
   - `QUEUE_URL`
   - `BUCKET_NAME`
4. The Lambda is exposed through **API Gateway** as an HTTP endpoint.

---

### Requirements

- A configured **ECR repository** for the image.  
- A **CodeBuild project** with permissions to build Docker images and push to ECR.  
- Terraform with access to your AWS credentials.  
- The `fastapi` and `boto3` Python packages inside the image.

---

This component is lightweight, stateless, and scales automatically through AWS Lambda. It can be reused as a base for other FastAPI-based serverless APIs.
